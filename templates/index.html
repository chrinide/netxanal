<!DOCTYPE HTML>
<HTML>
<HEAD>
  <TITLE>Application for basic network analysis</TITLE>
  <link rel="stylesheet" media="screen" href="{{ url_for('static', filename='css/bootstrap6.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
    <link rel="stylesheet" type="text/css" media="screen" href="{{ url_for('static', filename='css/bootstrap-responsive.css') }}"/>
    <link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/jquery-ui.css') }}">
    <script type=text/javascript>
	    $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
    </script>
  <script type="text/javascript" src="{{url_for('static', filename='js/jquery.js') }}"></script>
    <script src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/ie10-viewport-bug-workaround.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/jquery-ui.js') }}"></script>
  <script type="text/javascript" src="{{url_for('static', filename='js/queries.js') }}"></script>
  <script type="text/javascript" src="{{url_for('static', filename='js/jquery.tablesorter.js') }}"></script>
  <script type="text/javascript" src="{{url_for('static', filename='js/functios.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='js/editHTMLElements.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='js/graphImageHandler.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='js/graphInfoHandler.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='js/jQuery-UI-Initialization.js') }}"></script>
  <link rel=stylesheet type=text/css href="{{ url_for('static', filename='css/pagestyle.css') }}">
    <link rel="stylesheet" media="screen" type="text/css" href="{{ url_for('static', filename='css/colpick.css') }}" />
	<script type="text/javascript" src="{{ url_for('static', filename='js/colpick.js') }}"></script>
<script>
	window.onload=initReload;
	function initReload() {
	    $('#level').hide();
	    $('#colorbase').hide();
	    $('#sizeRanking').hide();
		$('#nameProject').hide();
	}
</script>
<script>
    $(function() {
       	$('.color-box').colpick({
			colorScheme:'dark',
			layout:'rgbhex',
			color:'ff8800',
			onSubmit:function(hsb,hex,rgb,el) {
				$(el).css('background-color', '#'+hex);
				$(el).colpickHide();
				updateImage(el.id.split("-")[1], "#" + hex);
			}
		});
    });
</script>
</HEAD>
{%if not session.showimage %}
<Body>
  <form enctype="multipart/form-data" method = "POST" action = "{{ url_for('draw_graph') }}">
    <p>File: <input type="file" name="file"></p><br>
	<p>Type of graph : <input type = "radio" name = "graphtype" value = "Undirected">Undirected
	<input type = "radio" name = "graphtype" value = "Directed">Directed</p>
    <p><input type="submit" value="Upload"></p><br>
  </form>
  <div id = "graphGeneration">
	   <h3>Generate Graph</h3>
	   <span>Choose a model</span>
	   <form method = "POST" action = "{{ url_for('random_graph') }}">
	   <select id = "model" name = "model" onchange = "selectGraphModel()">
		<option value = "erdos" selected>Erdos Renyi Graph</option>
		<option value = "watts_strogatz">Watts-Strogatz Graph</option>
		<option value = "binomial">Binomial Graph</option>
		<option value = "regular">Random Regular Graph</option>
		<option value = "random">Random Graph</option>
		<option value = "barabasi">Barabasi Albert Graph</option>
	   </select>
	   <p id = "modelDescription">Chooses each of the possible edges with a given probability.</p>
	   <p id = "parameters">
		Number of nodes: <input name = "nodes" type = "text"/><br>
		probability of edge creation: <input name = "probability" type = "text"/><br>
		Graph type: <input type = "radio" name = "graphtype" value = "Undirected">Undirected
		<input type = "radio" name = "graphtype" value = "Directed">Directed
	   </p>
	   <input type = "submit" value = "Generate graph">
	   </form>
   </div>
  <h2>List of my projects</h2>
  <form method = "post" action = "{{ url_for('open_project') }}">
  {% for project in projects %}
	<span>{{ project.filename }}</span>
	<input type = "radio" name = "project" value = "{{ project.filename }}"><br>
  {% else %}
	<h4>You do not have any projects yet</h4>
  {% endfor %}
  {% if projects.count() != 0 %}
	<input type = "submit" value = "Import selected project">
	<input type = "button" value = "Delete Selected Project" onclick = "deleteProject()">
  {% endif %}
  </form>
  <form method = "get" action = "{{ url_for('logout') }}">
     <input id = "logout" type = "submit" value = "Log out"/>
   </form>
   {{ message }}
</body>
  {% else %}
<body>
	<div class="ui-widget">
		<div class="ui-state-error ui-corner-all" style="padding: 0 .7em;">
			<label for="pages"><span class="ui-icon ui-icon-home" style="float: right; margin-right: .3em;"></span>
			Welcome to netXanal</label>&nbsp;&nbsp;
			<div id="pages" style="display: inline-block">
				<input onclick="location.href = 'graph';" type="radio" name="pages" id="mainpage"><label for="mainpage">Mainpage</label>
				<input onclick="location.href = 'node_info';" type="radio" name="pages" id="ginfo"><label for="ginfo">Graph Information</label>
				<input onclick="location.href = 'diagrams';" type="radio" name="pages" id="diagrams"><label for="diagrams">Diagrams</label>
			</div>
              <div class="dropdown" style="display: inline-block; float: right; margin-right: 5%;">
                <button class="btn btn-default dropdown-toggle" type="button" id="menu1" data-toggle="dropdown">{{ session.user }}
                <span class="caret"></span></button>
                <ul class="dropdown-menu" role="menu" aria-labelledby="menu1">
                  <li role="presentation" class="dropdown-header">Export files</li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="download_graph">Download Graph File
                  <span class="ui-icon ui-icon-circle-arrow-s" style="float: left; margin-right: .3em;"></span></a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="download_graph_image">Download Image
                  <span class="ui-icon ui-icon-circle-arrow-s" style="float: left; margin-right: .3em;"></span></a></li>
                  <li role="presentation" class="dropdown-header">User</li>
                  <li role="presentation"><a id="save-button" role="menuitem" tabindex="-1">Save Graph
                  <span class="ui-icon ui-icon-disk" style="float: left; margin-right: .3em;"></span></a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="import_file">Import a new Graph
                  <span class="ui-icon ui-icon-circle-plus" style="float: left; margin-right: .3em;"></span></a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="logout">Logout
                  <span class="ui-icon ui-icon-power" style="float: left; margin-right: .3em;"></span></a></li>
                </ul>
              </div>
            </div>
	</div><br>
    <div id="graphImage" style="height: 700px; width: 60%;">
        <div id="toolbar" class="ui-state-error ui-corner-all">
            <label for="update-layout">Layout: </label>
            <select id = "update-layout">
              <option value = "random" selected>Random</option>
              <option value = "circular">Circular</option>
              <option value = "spring">Spring</option>
              <option value = "spectral">Spectral</option>
              <option value = "shell">Shell</option>
            </select>&nbsp;
            <label for="update-node_size">Node size: </label>
            <div id="update-node_size" style="width: 10%; display: inline-block;"></div>
            <label for="update-edge_width">Edge width: </label>
            <div id="update-edge_width" style="width: 10%; display: inline-block;"></div>
            <label for="update-font_size">Font size: </label>
            <div id="update-font_size" style="width: 10%; display: inline-block;"></div>
            <label for="update-node_shape">Node shape: </label>
            <div id="update-node_shape" style="display: inline-block">
                <input checked onclick="updateImage('node_shape')" value="o" type="radio" name="shape" id="circle"><label for="circle"><span class="ui-icon ui-icon-bullet"></span></label>
                <input onclick="updateImage('node_shape')" value="s" type="radio" name="shape" id="square"><label for="square"><span class="ui-icon ui-icon-squaresmall-plus"></span></label>
                <input onclick="updateImage('node_shape')" value="h" type="radio" name="shape" id="hexagon"><label for="hexagon"><span class="ui-icon ui-icon-star"></span></label>
                <input onclick="updateImage('node_shape')" value="^" type="radio" name="shape" id="arrow-up"><label for="arrow-up"><span class="ui-icon ui-icon-triangle-1-n"></span></label>
                <input onclick="updateImage('node_shape')" value="v" type="radio" name="shape" id="arrow-bottom"><label for="arrow-bottom"><span class="ui-icon ui-icon-triangle-1-s"></span></label>
                <input onclick="updateImage('node_shape')" value=">" type="radio" name="shape" id="arrow-right"><label for="arrow-right"><span class="ui-icon ui-icon-triangle-1-e"></span></label>
                <input onclick="updateImage('node_shape')" value="<" type="radio" name="shape" id="arrow-left"><label for="arrow-left"><span class="ui-icon ui-icon-triangle-1-w"></span></label>
            </div>
            <label for="update-edge_style">Edge style: </label>
            <select id="update-edge_style">
                <option value = "solid" selected>solid</option>
                <option value = "dashed">dashed</option>
                <option value = "dotted">dotted</option>
                <option value = "dashdot">dashdot</option>
            </select>
            {% if is_weighted %}
            <label for="update-edge_labels">Edge labels: </label>
                <div id="update-edge_labels" style="display: inline-block;">
                    <input checked onclick="updateImage('edge_labels')" value="True" type="radio" name="edge_label" id="edge_ON"><label for="edge_ON">ON</label>
                    <input onclick="updateImage('edge_labels')" value="False" type="radio" name="edge_label" id="edge_OFF"><label for="edge_OFF">OFF</label>
                </div>
            {% else %}
                <br>
            {% endif %}
            <label for="colors">Change color: </label>
            <div id="colors" style="display: inline-block;">
                <div id="update-node_color" class="color-box">N</div>
                <div id="update-edge_color" class="color-box">E</div>
                <div id="update-font_color" class="color-box">F</div>
            </div>
        </div>
        <img src="{{ url }}" style="width: 100%;">
    </div>
    <div id="operations">
    	<h3>General Information</h3>
        <div id="generalInfo">
            <div class="ui-widget">
                <div class="ui-state-highlight">
                    <p>
                        <span class="ui-icon ui-icon-info" style="float: left; margin-right: .3em; font-size: 10px;"></span>
                        {% if growing %}
                            <b style="font-size: 20px;">Dynamic Graph</b><br>
                        {% else %}
                            <b style="font-size: 20px;">Static Graph</b><br>
                        {% endif %}
                        <b>Graph type: </b>
                        <span id = "graph_type">{{name}}</span><br>
   						<b>Is weighted: </b>
   						<span id = "is_weighted">{{ is_weighted }}</span>
   						<b>Total nodes: </b>{{number_of_nodes}}<br>
   						<b>Total edges: </b>{{edges}}<br>
   						<b>Directed Acyclic Graph: </b>{{ is_DAG }}<br>
   						<b>Fully connected: </b>{{ is_connected }}<br>
   						<b>Graph density: </b>{{ density }}<br>
   						<b>Negative weights: </b>{{ negative_weights }}<br>
   						<b>Negative cycle: </b>{{negative_cycle}}<br>
   						<b>Diameter based on path length: </b>{{diameter[0]}}<br><br>
                    </p>
                </div>
            </div>
        </div>
    {% if growing %}
        <h3>Add/Delete nodes</h3>
        <div id="updateGraph">
            <label for="addition-deletion">Update Graph: </label>
            <div id="addition-deletion" style="display: inline-block">
                <input name="update" type="radio" id="addition" onclick="location.href = 'add_node';">
                <label for="addition">Add a new node<span style="float: right; margin-right: .3em;" class="ui-icon ui-icon-circle-plus"></span></label>
                <input name="update" type="radio" id="deletion" onclick="location.href = 'delete_node';">
                <label for="deletion">Delete a node<span style="float: right; margin-right: .3em;" class="ui-icon ui-icon-circle-minus"></span></label>
            </div><br><br>
            {% if new_edges %}
                <div class="ui-widget">
                    <div class="ui-corner-all ui-state-highlight" style="padding: 0.7em;">
                        <p>
                            <span class="ui-icon ui-icon-info"></span>
                            <b>New edges: </b>{{ new_edges }}
                        </p>
                    </div>
                </div>
            {% endif %}
        </div>
    {% endif %}
    <h3>Find paths</h3>
    <div id="path">
        <label for="#source">Select source node: </label>
	   <select id = "source" name = "source">
	    {% for node in nodes %}
           <option value = "{{ node }}">Node: {{ node }}</option>
        {% endfor %}
       </select><br>
        <label for="#target">Select target node: </label>
	   <select id = "target" name = "target">
	    {% for node in nodes %}
           <option value = "{{ node }}">Node: {{ node }}</option>
        {% endfor %}
	   </select><br>
        <label for="path-type">Select type of path: </label>
        <div id="path-type" style="font-size: 11px; display: inline-block;">
            {% if not negative_cycle %}
            	<input checked id="shortest" type="radio" name="pathType" value="shortest"><label for="shortest">Shortest path</label>
            {% endif %}
        	{% if is_DAG %}
            	<input checked id="critical" type="radio" name="pathType" value="critical"><label for="critical">Critical path</label>
            {% endif %}
        	{% if is_weighted %}
            	<input checked id="strongest" type="radio" name="pathType" value="strongest"><label for="strongest">Strongest path</label>
            {% endif %}
        </div><br>
        <button id="findPath" onclick="findPaths()">Search Path</button>
        <div id="pathInfo" class="ui-widget">
        </div>
    </div>
    <h3>Find communities</h3>
    <div id="communities">
        <button id="findCommunities" onclick="findCommunities()">Find communities</button><br><br>
        <div class="ui-widget">
            <div id="communitiesInfo" class="ui-state-highlight ui-corner-all" style="padding: 0 .7em;">
            </div>
        </div><br><br>
        <div class="ui-widget">
            <div class="ui-state-error ui-corner-all" style="padding: 0 .7em;">
                <p style="font-size: 10px;"><span class="ui-icon ui-icon-alert" style="float: left; margin-right: .3em;"></span>
                <strong>Note: </strong>Use of Girvan - Newman algorithm for community detection</p>
            </div>
        </div>
    </div>
    <h3>Find cliques</h3>
    <div id="cliques">
        <button id="findCliques" onclick="findCliques()">Find cliques</button>
        <div id="cliquesInfo" class="ui-widget">
        </div>
    </div>
    <h3>Rank nodes</h3>
    <div id="rank-nodes">
        <label for="rankings">Select ranking way: </label>
        <div id="rankings" style="font-size: 11px; display: inline-block;">
            <input onclick="changeRankingWay('color')" checked id="color" type="radio" name="ranking-way" value="colorRanking"><label for="color">Color ranking</label>
            <input onclick="changeRankingWay('size')" id="size" type="radio" name="ranking-way" value="sizeRanking"><label for="size">Size ranking</label>
            <input onclick="changeRankingWay('both')" id="both" type="radio" name="ranking-way" value="bothRanking"><label for="both">Color and Size ranking</label>
        </div><br><br>
        {% for i in range(0, 2) %}
	   	    {% if i == 0 %}
	   		<div id = "colorRanking">
	   			List of colors diversities
	   		    <select id = "color-map" name = "colors">
                    <option id="cool" value = "cool">Cool</option>
                    <option id="hot" value="hot">Hot</option>
                    <option id="winter" value="winter">Winter</option>
                    <option id="spring"  value = "spring">Spring</option>
                    <option id="summer" value="summer">Summer</option>
                    <option id="autumn" value="autumn">Autumn</option>
                    <option id="red-blue" value = "RdBu">Red-Blue</option>
                    <option id="red-grey"  value = "RdGy">Red-Grey</option>
                    <option id="pink-green" value = "PiYG">Pink-Green</option>
                    <option id="green-blue" value = "GnBu">Green-Blue</option>
                    <option value = "YlGn">Yellow-Green</option>
                    <option value = "Greens">Greens</option>
                    <option value = "Blues">Blues</option>
                    <option value = "Greys">Greys</option>
                    <option value = "Reds">Reds</option>
                </select><br><br>
				Color Nodes based on:
	   			<select id = "colorNodes" name = "colorNodes">
	   	    {% else %}
	   		    <div id = "sizeRanking">
				    Rank Node size based on:
	   			    <select id = "sizeNodes" name = "sizeNodes">
	   	    {% endif %}
                <option value = "betweenness">Betweeness Centrality</option>
                <option value = "closeness">Closeness Centrality</option>
                <option value = "eigenvector">Eigenvector Centrality</option>
            {% if name == 'Directed' %}
                <option value = "in_degree">In-Degree Centrality</option>
                <option value = "out_degree">Out-Degree Centrality</option>
                <option value = "pagerank">PageRank</option>
                {% if is_weighted %}
                    <option value = "weighted_in_degree">Weighted In-Degree</option>
                    <option value = "weighted_out_degree">Weighted Out-Degree</option>
                {% endif %}
            {% else %}
                <option value = "degree">Degree Centrality</option>
                <option value = "clustering">Clustering Coefficient</option>
                {% if is_weighted %}
                    <option value = "weighted_degree">Weighted Degree</option>
                {% endif %}
            {% endif %}
            </select>
	        </div>
		{% endfor %}
        <button onclick="rankNodes()">Rank nodes</button>
    </div>
    </div>
    {% include "select_project.html" %}
   </body>
   {% endif %}
</HTML>